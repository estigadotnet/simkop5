CREATE VIEW `v02_nasabahjaminan` AS select `a`.`id` AS `id`,`a`.`Nama` AS `Nama`,`a`.`Alamat` AS `Alamat`,`a`.`No_Telp_Hp` AS `No_Telp_Hp`,`a`.`Pekerjaan` AS `Pekerjaan`,`a`.`Pekerjaan_Alamat` AS `Pekerjaan_Alamat`,`a`.`Pekerjaan_No_Telp_Hp` AS `Pekerjaan_No_Telp_Hp`,`a`.`Status` AS `Status`,`a`.`Keterangan` AS `Keterangan`,`a`.`marketing_id` AS `marketing_id`,group_concat(`b`.`id` separator ',') AS `jaminan_id` from (`t01_nasabah` `a` left join `t02_jaminan` `b` on((`a`.`id` = `b`.`nasabah_id`))) group by `a`.`id`;
CREATE VIEW `v03_jurnalmemorial` AS select `a`.`id` AS `id`,`a`.`Tanggal` AS `Tanggal`,`a`.`NomorTransaksi` AS `NomorTransaksi`,`a`.`Keterangan` AS `Keterangan`,`a`.`Periode` AS `Periode`,`b`.`Rekening` AS `Rekening`,`b`.`Debet` AS `Debet`,`b`.`Kredit` AS `Kredit` from (`t11_jurnalmaster` `a` left join `t12_jurnaldetail` `b` on((`a`.`id` = `b`.`jurnalmaster_id`))) order by `b`.`id`;
CREATE VIEW `v0301_pinjamannasabah` AS select `p`.`id` AS `pinjaman_id`,`p`.`Kontrak_No` AS `Kontrak_No`,`p`.`Kontrak_Tgl` AS `Kontrak_Tgl`,`p`.`nasabah_id` AS `nasabah_id`,`p`.`jaminan_id` AS `jaminan_id`,`p`.`Pinjaman` AS `Pinjaman`,`p`.`Angsuran_Lama` AS `Angsuran_Lama`,`p`.`Angsuran_Bunga_Prosen` AS `Angsuran_Bunga_Prosen`,`p`.`Angsuran_Denda` AS `Angsuran_Denda`,`p`.`Dispensasi_Denda` AS `Dispensasi_Denda`,`p`.`Angsuran_Pokok` AS `Angsuran_Pokok`,`p`.`Angsuran_Bunga` AS `Angsuran_Bunga`,`p`.`Angsuran_Total` AS `Angsuran_Total`,`p`.`No_Ref` AS `No_Ref`,`p`.`Biaya_Administrasi` AS `Biaya_Administrasi`,`p`.`Biaya_Materai` AS `Biaya_Materai`,`p`.`marketing_id` AS `marketing_id`,`p`.`Periode` AS `Periode`,`p`.`Macet` AS `Macet`,`n`.`Nama` AS `Nama`,`n`.`Alamat` AS `Alamat`,`n`.`No_Telp_Hp` AS `No_Telp_Hp`,`n`.`Pekerjaan` AS `Pekerjaan`,`n`.`Pekerjaan_Alamat` AS `Pekerjaan_Alamat`,`n`.`Pekerjaan_No_Telp_Hp` AS `Pekerjaan_No_Telp_Hp`,`n`.`Status` AS `Status`,`n`.`Keterangan` AS `Keterangan` from (`t03_pinjaman` `p` left join `t01_nasabah` `n` on((`p`.`nasabah_id` = `n`.`id`)));
CREATE VIEW `v0303_pinjamanlap2` AS select `p`.`id` AS `id`,`pd`.`Angsuran_Tanggal` AS `angsuran_tanggal` from (`t03_pinjaman` `p` left join `t04_pinjamanangsurantemp` `pd` on((`p`.`id` = `pd`.`pinjaman_id`))) order by `pd`.`Angsuran_Tanggal` desc limit 1;
CREATE VIEW `v0304_pinjamanlap3` AS select `p`.`id` AS `id`,count(`pd`.`id`) AS `sudah_bayar` from (`t03_pinjaman` `p` left join `t04_pinjamanangsurantemp` `pd` on((`p`.`id` = `pd`.`pinjaman_id`))) where ((`pd`.`Tanggal_Bayar` is not null) or (`pd`.`Tanggal_Bayar` <> '')) group by `pd`.`pinjaman_id`;
CREATE VIEW `v0305_pinjamanlap4` AS select `p`.`id` AS `id`,sum(`pd`.`Angsuran_Pokok`) AS `pd_Angsuran_Pokok`,sum(`pd`.`Angsuran_Bunga`) AS `pd_Angsuran_Bunga` from (`t03_pinjaman` `p` left join `t04_pinjamanangsurantemp` `pd` on((`p`.`id` = `pd`.`pinjaman_id`))) where (isnull(`pd`.`Tanggal_Bayar`) or (`pd`.`Tanggal_Bayar` = ''));
CREATE VIEW `v0302_pinjamanlap` AS select `p`.`id` AS `pinjaman_id`,`p`.`Kontrak_No` AS `Kontrak_No`,`p`.`Kontrak_Tgl` AS `Kontrak_Tgl`,`p`.`nasabah_id` AS `nasabah_id`,`p`.`jaminan_id` AS `jaminan_id`,`p`.`Pinjaman` AS `Pinjaman`,`p`.`Angsuran_Lama` AS `Angsuran_Lama`,`p`.`Angsuran_Bunga_Prosen` AS `Angsuran_Bunga_Prosen`,`p`.`Angsuran_Denda` AS `Angsuran_Denda`,`p`.`Dispensasi_Denda` AS `Dispensasi_Denda`,`p`.`Angsuran_Pokok` AS `Angsuran_Pokok`,`p`.`Angsuran_Bunga` AS `Angsuran_Bunga`,`p`.`Angsuran_Total` AS `Angsuran_Total`,`p`.`No_Ref` AS `No_Ref`,`p`.`Biaya_Administrasi` AS `Biaya_Administrasi`,`p`.`Biaya_Materai` AS `Biaya_Materai`,`p`.`marketing_id` AS `marketing_id`,`p`.`Periode` AS `Periode`,`p`.`Macet` AS `Macet`,`n`.`Nama` AS `NasabahNama`,`n`.`Alamat` AS `NasabahAlamat`,`n`.`No_Telp_Hp` AS `No_Telp_Hp`,`n`.`Pekerjaan` AS `Pekerjaan`,`n`.`Pekerjaan_Alamat` AS `Pekerjaan_Alamat`,`n`.`Pekerjaan_No_Telp_Hp` AS `Pekerjaan_No_Telp_Hp`,`n`.`Status` AS `Status`,`n`.`Keterangan` AS `NasabahKeterangan`,`m`.`Nama` AS `MarketingNama`,`m`.`Alamat` AS `MarketingAlamat`,`m`.`NoHP` AS `NoHP`,`pd`.`angsuran_tanggal` AS `AkhirKontrak`,`pd3`.`sudah_bayar` AS `sudah_bayar`,`pd4`.`pd_Angsuran_Pokok` AS `pd_Angsuran_Pokok`,`pd4`.`pd_Angsuran_Bunga` AS `pd_Angsuran_Bunga`,(`pd4`.`pd_Angsuran_Pokok` + `pd4`.`pd_Angsuran_Bunga`) AS `pd_Angsuran_Total` from (((((`t03_pinjaman` `p` left join `t01_nasabah` `n` on((`p`.`nasabah_id` = `n`.`id`))) left join `t07_marketing` `m` on((`p`.`marketing_id` = `m`.`id`))) left join `v0303_pinjamanlap2` `pd` on((`p`.`id` = `pd`.`id`))) left join `v0304_pinjamanlap3` `pd3` on((`p`.`id` = `pd3`.`id`))) left join `v0305_pinjamanlap4` `pd4` on((`p`.`id` = `pd4`.`id`)));

CREATE VIEW `v30_mutasi` AS select `j`.`Rekening` AS `id`,sum(`j`.`Debet`) AS `debet`,sum(`j`.`Kredit`) AS `kredit` from `t10_jurnal` `j` group by `j`.`Rekening`;
CREATE VIEW `v31_mutasi` AS select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) AS `saldoakhir` from ((`t91_rekening` `r` left join `t91_rekening` `r2` on((`r`.`group` = `r2`.`id`))) left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '1')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) AS `saldoakhir` from ((`t91_rekening` `r` left join `t91_rekening` `r2` on((`r`.`group` = `r2`.`id`))) left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '2')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) AS `saldoakhir` from ((`t91_rekening` `r` left join `t91_rekening` `r2` on((`r`.`group` = `r2`.`id`))) left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '3')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) AS `saldoakhir` from ((`t91_rekening` `r` left join `t91_rekening` `r2` on((`r`.`group` = `r2`.`id`))) left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '4')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) AS `saldoakhir` from ((`t91_rekening` `r` left join `t91_rekening` `r2` on((`r`.`group` = `r2`.`id`))) left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '5')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) AS `saldoakhir` from ((`t91_rekening` `r` left join `t91_rekening` `r2` on((`r`.`group` = `r2`.`id`))) left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '6')) order by `id`;
CREATE VIEW `v32_labarugi` AS select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir`,(`m`.`kredit` - `m`.`debet`) AS `jumlah` from `v31_mutasi` `m` where (`m`.`group` = '3') union select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir`,(`m`.`kredit` - `m`.`debet`) AS `jumlah` from `v31_mutasi` `m` where (`m`.`group` = '5') union select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir`,(`m`.`debet` - `m`.`kredit`) AS `jumlah` from `v31_mutasi` `m` where (`m`.`group` = '4') union select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir`,(`m`.`debet` - `m`.`kredit`) AS `jumlah` from `v31_mutasi` `m` where (`m`.`group` = '6') order by `id`;
CREATE VIEW `v33_neraca` AS select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir` from `v31_mutasi` `m` where ((`m`.`group` = '1') or (`m`.`group` = '2'));
CREATE VIEW `v34_saldoakhir` AS select `r`.`id` AS `id`,`r`.`rekening` AS `rekening`,(`r`.`Saldo` + ((case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end))) AS `saldo` from (`t91_rekening` `r` left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((length(`r`.`id`) > 1) and (left(`r`.`id`,1) = '1')) union select `r`.`id` AS `id`,`r`.`rekening` AS `rekening`,(`r`.`Saldo` + ((case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end))) AS `saldo` from (`t91_rekening` `r` left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((length(`r`.`id`) > 1) and (left(`r`.`id`,1) = '2')) union select `r`.`id` AS `id`,`r`.`rekening` AS `rekening`,(`r`.`Saldo` + ((case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end))) AS `saldo` from (`t91_rekening` `r` left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((length(`r`.`id`) > 1) and (left(`r`.`id`,1) = '3')) union select `r`.`id` AS `id`,`r`.`rekening` AS `rekening`,(`r`.`Saldo` + ((case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end))) AS `saldo` from (`t91_rekening` `r` left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((length(`r`.`id`) > 1) and (left(`r`.`id`,1) = '4')) union select `r`.`id` AS `id`,`r`.`rekening` AS `rekening`,(`r`.`Saldo` + ((case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end))) AS `saldo` from (`t91_rekening` `r` left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((length(`r`.`id`) > 1) and (left(`r`.`id`,1) = '5')) union select `r`.`id` AS `id`,`r`.`rekening` AS `rekening`,(`r`.`Saldo` + ((case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end))) AS `saldo` from (`t91_rekening` `r` left join `v30_mutasi` `m` on((`r`.`id` = convert(`m`.`id` using utf8)))) where ((length(`r`.`id`) > 1) and (left(`r`.`id`,1) = '6'));

CREATE VIEW `v40_mutasiold` AS select `j`.`Periode` AS `periode`,`j`.`Rekening` AS `id`,sum(`j`.`Debet`) AS `debet`,sum(`j`.`Kredit`) AS `kredit` from (`t92_periodeold` `p` left join `t82_jurnalold` `j` on((`p`.`Tahun_Bulan` = `j`.`Periode`))) group by `j`.`Periode`,`j`.`Rekening` order by `j`.`Rekening`;
CREATE VIEW `v41_mutasiold` AS select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) AS `saldoakhir` from (((`t92_periodeold` `p` left join `t80_rekeningold` `r` on((convert(`p`.`Tahun_Bulan` using utf8) = `r`.`Periode`))) left join `t80_rekeningold` `r2` on(((`r`.`group` = `r2`.`id`) and (convert(`p`.`Tahun_Bulan` using utf8) = `r2`.`Periode`)))) left join `v40_mutasiold` `m` on(((`r`.`id` = convert(`m`.`id` using utf8)) and (`m`.`periode` = `r`.`Periode`)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '1')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) AS `saldoakhir` from (((`t92_periodeold` `p` left join `t80_rekeningold` `r` on((convert(`p`.`Tahun_Bulan` using utf8) = `r`.`Periode`))) left join `t80_rekeningold` `r2` on(((`r`.`group` = `r2`.`id`) and (convert(`p`.`Tahun_Bulan` using utf8) = `r2`.`Periode`)))) left join `v40_mutasiold` `m` on(((`r`.`id` = convert(`m`.`id` using utf8)) and (`m`.`periode` = `r`.`Periode`)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '2')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) AS `saldoakhir` from (((`t92_periodeold` `p` left join `t80_rekeningold` `r` on((convert(`p`.`Tahun_Bulan` using utf8) = `r`.`Periode`))) left join `t80_rekeningold` `r2` on(((`r`.`group` = `r2`.`id`) and (convert(`p`.`Tahun_Bulan` using utf8) = `r2`.`Periode`)))) left join `v40_mutasiold` `m` on(((`r`.`id` = convert(`m`.`id` using utf8)) and (`m`.`periode` = `r`.`Periode`)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '3')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) AS `saldoakhir` from (((`t92_periodeold` `p` left join `t80_rekeningold` `r` on((convert(`p`.`Tahun_Bulan` using utf8) = `r`.`Periode`))) left join `t80_rekeningold` `r2` on(((`r`.`group` = `r2`.`id`) and (convert(`p`.`Tahun_Bulan` using utf8) = `r2`.`Periode`)))) left join `v40_mutasiold` `m` on(((`r`.`id` = convert(`m`.`id` using utf8)) and (`m`.`periode` = `r`.`Periode`)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '4')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) - (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) AS `saldoakhir` from (((`t92_periodeold` `p` left join `t80_rekeningold` `r` on((convert(`p`.`Tahun_Bulan` using utf8) = `r`.`Periode`))) left join `t80_rekeningold` `r2` on(((`r`.`group` = `r2`.`id`) and (convert(`p`.`Tahun_Bulan` using utf8) = `r2`.`Periode`)))) left join `v40_mutasiold` `m` on(((`r`.`id` = convert(`m`.`id` using utf8)) and (`m`.`periode` = `r`.`Periode`)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '5')) union select `r`.`Periode` AS `periode`,`r`.`group` AS `group`,`r2`.`rekening` AS `group_rekening`,`r`.`id` AS `id`,`r`.`rekening` AS `rekening`,`r`.`Saldo` AS `saldoawal`,(case when isnull(`m`.`debet`) then 0 else `m`.`debet` end) AS `debet`,(case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end) AS `kredit`,((`r`.`Saldo` + (case when isnull(`m`.`debet`) then 0 else `m`.`debet` end)) - (case when isnull(`m`.`kredit`) then 0 else `m`.`kredit` end)) AS `saldoakhir` from (((`t92_periodeold` `p` left join `t80_rekeningold` `r` on((convert(`p`.`Tahun_Bulan` using utf8) = `r`.`Periode`))) left join `t80_rekeningold` `r2` on(((`r`.`group` = `r2`.`id`) and (convert(`p`.`Tahun_Bulan` using utf8) = `r2`.`Periode`)))) left join `v40_mutasiold` `m` on(((`r`.`id` = convert(`m`.`id` using utf8)) and (`m`.`periode` = `r`.`Periode`)))) where ((`r`.`tipe` = 'DETAIL') and (`r`.`group` = '6')) order by `id`;
CREATE VIEW `v42_labarugiold` AS select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir`,(`m`.`kredit` - `m`.`debet`) AS `jumlah` from `v41_mutasiold` `m` where (`m`.`group` = '3') union select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir`,(`m`.`kredit` - `m`.`debet`) AS `jumlah` from `v41_mutasiold` `m` where (`m`.`group` = '5') union select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir`,(`m`.`debet` - `m`.`kredit`) AS `jumlah` from `v41_mutasiold` `m` where (`m`.`group` = '4') union select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir`,(`m`.`debet` - `m`.`kredit`) AS `jumlah` from `v41_mutasiold` `m` where (`m`.`group` = '6') order by `id`;
CREATE VIEW `v43_neracaold` AS select `m`.`periode` AS `periode`,`m`.`group` AS `group`,`m`.`group_rekening` AS `group_rekening`,`m`.`id` AS `id`,`m`.`rekening` AS `rekening`,`m`.`saldoawal` AS `saldoawal`,`m`.`debet` AS `debet`,`m`.`kredit` AS `kredit`,`m`.`saldoakhir` AS `saldoakhir` from `v41_mutasiold` `m` where ((`m`.`group` = '1') or (`m`.`group` = '2'));
