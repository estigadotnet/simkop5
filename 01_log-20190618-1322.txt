1:23 PM 6/18/2019

view yang diubah adalah ::
	- v0303_pinjamanlap2
	- v0304_pinjamanlap3
	- v0305_pinjamanlap4
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v0302_pinjamanlap` AS select `p`.`id` AS `pinjaman_id`,`p`.`Kontrak_No` AS `Kontrak_No`,`p`.`Kontrak_Tgl` AS `Kontrak_Tgl`,`p`.`nasabah_id` AS `nasabah_id`,`p`.`jaminan_id` AS `jaminan_id`,`p`.`Pinjaman` AS `Pinjaman`,`p`.`Angsuran_Lama` AS `Angsuran_Lama`,`p`.`Angsuran_Bunga_Prosen` AS `Angsuran_Bunga_Prosen`,`p`.`Angsuran_Denda` AS `Angsuran_Denda`,`p`.`Dispensasi_Denda` AS `Dispensasi_Denda`,`p`.`Angsuran_Pokok` AS `Angsuran_Pokok`,`p`.`Angsuran_Bunga` AS `Angsuran_Bunga`,`p`.`Angsuran_Total` AS `Angsuran_Total`,`p`.`No_Ref` AS `No_Ref`,`p`.`Biaya_Administrasi` AS `Biaya_Administrasi`,`p`.`Biaya_Materai` AS `Biaya_Materai`,`p`.`marketing_id` AS `marketing_id`,`p`.`Periode` AS `Periode`,`p`.`Macet` AS `Macet`,`n`.`Nama` AS `NasabahNama`,`n`.`Alamat` AS `NasabahAlamat`,`n`.`No_Telp_Hp` AS `No_Telp_Hp`,`n`.`Pekerjaan` AS `Pekerjaan`,`n`.`Pekerjaan_Alamat` AS `Pekerjaan_Alamat`,`n`.`Pekerjaan_No_Telp_Hp` AS `Pekerjaan_No_Telp_Hp`,`n`.`Status` AS `Status`,`n`.`Keterangan` AS `NasabahKeterangan`,`m`.`Nama` AS `MarketingNama`,`m`.`Alamat` AS `MarketingAlamat`,`m`.`NoHP` AS `NoHP`,`pd`.`angsuran_tanggal` AS `AkhirKontrak`,`pd3`.`sudah_bayar` AS `sudah_bayar`,`pd4`.`pd_Angsuran_Pokok` AS `pd_Angsuran_Pokok`,`pd4`.`pd_Angsuran_Bunga` AS `pd_Angsuran_Bunga`,(`pd4`.`pd_Angsuran_Pokok` + `pd4`.`pd_Angsuran_Bunga`) AS `pd_Angsuran_Total`,`pd5`.`tanggal_bayar` AS `Tanggal_Bayar`,(case when isnull(`pd4`.`pd_Angsuran_Pokok`) then 0 else `pd5`.`umur_tunggakan` end) AS `umur_tunggakan` from ((((((`t03_pinjaman` `p` left join `t01_nasabah` `n` on((`p`.`nasabah_id` = `n`.`id`))) left join `t07_marketing` `m` on((`p`.`marketing_id` = `m`.`id`))) left join `v0303_pinjamanlap2` `pd` on((`p`.`id` = `pd`.`id`))) left join `v0304_pinjamanlap3` `pd3` on((`p`.`id` = `pd3`.`id`))) left join `v0305_pinjamanlap4` `pd4` on((`p`.`id` = `pd4`.`id`))) left join `v0306_pinjamanlap5` `pd5` on((`p`.`id` = `pd5`.`id`)))
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v0303_pinjamanlap2` AS select `p`.`id` AS `id`,max(`pd`.`Angsuran_Tanggal`) AS `angsuran_tanggal` from (`t03_pinjaman` `p` left join `t04_pinjamanangsurantemp` `pd` on((`p`.`id` = `pd`.`pinjaman_id`))) group by `p`.`id` order by `pd`.`Angsuran_Tanggal` desc
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v0304_pinjamanlap3` AS select `p`.`id` AS `id`,count(`pd`.`id`) AS `sudah_bayar` from (`t03_pinjaman` `p` left join `t04_pinjamanangsurantemp` `pd` on((`p`.`id` = `pd`.`pinjaman_id`))) where ((`pd`.`Tanggal_Bayar` is not null) and (`pd`.`Tanggal_Bayar` <> '') and (`pd`.`Tanggal_Bayar` <> '0000-00-00')) group by `pd`.`pinjaman_id`
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v0305_pinjamanlap4` AS select `p`.`id` AS `id`,sum(`pd`.`Angsuran_Pokok`) AS `pd_Angsuran_Pokok`,sum(`pd`.`Angsuran_Bunga`) AS `pd_Angsuran_Bunga` from (`t03_pinjaman` `p` left join `t04_pinjamanangsurantemp` `pd` on((`p`.`id` = `pd`.`pinjaman_id`))) where (isnull(`pd`.`Tanggal_Bayar`) or (`pd`.`Tanggal_Bayar` = '')) group by `p`.`id`
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v0306_pinjamanlap5` AS select `p`.`id` AS `id`,max(`pd`.`Tanggal_Bayar`) AS `tanggal_bayar`,(to_days(curdate()) - to_days(max(`pd`.`Tanggal_Bayar`))) AS `umur_tunggakan` from (`t03_pinjaman` `p` left join `t04_pinjamanangsurantemp` `pd` on((`p`.`id` = `pd`.`pinjaman_id`))) where ((`pd`.`Tanggal_Bayar` is not null) and (`pd`.`Tanggal_Bayar` <> '') and (`pd`.`Tanggal_Bayar` <> '0000-00-00')) group by `p`.`id`
